{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Products" %} — Stock Hive{% endblock %}

{% block page_title %}{% endblock %}

{% block content %}
<div class="container">
  <div class="d-flex align-items-center justify-content-between">
    <h4 class="mb-0">{% trans "Products" %}</h4>
    <a href="{% url 'products:add' %}" class="btn btn-primary btn-sm">
      <i class="bi bi-plus-lg me-1"></i>{% trans "Add product" %}
    </a>
  </div>

  <form method="get" class="d-flex gap-2 mb-3">
  <input type="text" name="q" value="{{ q }}" class="form-control" placeholder="{% trans 'Search…' %}" />
  <select name="order" class="form-select">
    <option value="name"  {% if order == 'name' %}selected{% endif %}>{% trans 'Name ↑' %}</option>
    <option value="-name" {% if order == '-name' %}selected{% endif %}>{% trans 'Name ↓' %}</option>
    <option value="qty"   {% if order == 'qty' %}selected{% endif %}>{% trans 'Quantity ↑' %}</option>
    <option value="-qty"  {% if order == '-qty' %}selected{% endif %}>{% trans 'Quantity ↓' %}</option>
    <option value="new"   {% if order == 'new' %}selected{% endif %}>{% trans 'Newest' %}</option>
    <option value="old"   {% if order == 'old' %}selected{% endif %}>{% trans 'Oldest' %}</option>
  </select>
  <button class="btn btn-outline-secondary">{% trans 'Apply' %}</button>
</form>


  <div class="row g-3 mt-3">
    {% for p in items %}
      <div class="col-md-4 col-lg-3">
        <a class="card shadow-sm h-100 text-decoration-none" href="{% url 'products:detail' p.pk %}">
          <div class="card-body">
            <h6 class="mb-1">{{ p.name }}</h6>
            <div class="text-muted small">
              {% trans "Qty" %}: {{ p.quantity }}{% if p.unit %} {{ p.unit }}{% endif %}
            </div>
            {% if p.category %}<div class="small text-muted mt-1">{{ p.category.name }}</div>{% endif %}
          </div>
        </a>
      </div>
    {% empty %}
      <div class="col-12">
        <div class="alert alert-light border">{% trans "No products yet." %}</div>
      </div>
    {% endfor %}
  </div>

  {% if items.paginator.num_pages > 1 %}
    <nav class="mt-3">
      <ul class="pagination">
        {% if items.has_previous %}
          <li class="page-item"><a class="page-link" href="?page={{ items.previous_page_number }}&q={{ q }}">{{ _('Prev') }}</a></li>
        {% else %}<li class="page-item disabled"><span class="page-link">{{ _('Prev') }}</span></li>{% endif %}
        <li class="page-item disabled"><span class="page-link">{{ items.number }} / {{ items.paginator.num_pages }}</span></li>
        {% if items.has_next %}
          <li class="page-item"><a class="page-link" href="?page={{ items.next_page_number }}&q={{ q }}">{{ _('Next') }}</a></li>
        {% else %}<li class="page-item disabled"><span class="page-link">{{ _('Next') }}</span></li>{% endif %}
      </ul>
    </nav>
  {% endif %}
</div>
{% endblock %}
